<div class="row">
	<div class="col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3">
		<form id="form" class="panel panel-default" action="#">
			<div class="panel-heading">Informações do Quiz</div>
			<div class="panel-body no-bottom">

                <div class="form-group">
                    <input type="file" id="filepond" name="image" data-max-file-size="5MB" accept="image/png, image/jpeg, image/gif">
                </div>

                <div class="form-group">
                    <label for="titulo">Nome do quiz:</label>
                    <input type="text" id="titulo" name="titulo" class="form-control" required  />
                </div>

                <div class="form-group">
                    <label for="descricao">Descrição: </label>
                    <textarea id="desc" rows="3" name="desc" class="form-control"></textarea>
                </div>

                <div class="form-group">
                    <label for="estilo">Tipo :</label>
                    <select id="estilo" class="form-control" name="tipo" size="1">

                        <option>Selecione...</option>
                        <% for (var i = 0; i < lista.length; i++) { %>
                            <option value="<%= lista[i].tipo_id %>"> <%= lista[i].tipo_nome %></option>
                        <% } %>


                    </select>
                </div>
            </div>

            <div class="panel-footer text-center">
                <button name="clear" class="btn btn-default btn-outline" type="reset">Limpar</button>
                <button name="create" class="btn btn-primary" type="submit">Criar</button>
                <!--<input value="Salvar Alterações" class="btn btn-primary btn-lg btn-block" type="submit" />-->
            </div>
        </form>
    </div>
</div>

<%- contentFor("styles") %>
<style type="text/css">

.filepond--root { 
    font-size: 1.5rem; 
}

</style>


<%- contentFor("scripts") %>
<script type="text/javascript">
    "use strict";

    //FilePond Config
    FilePond.registerPlugin(
        FilePondPluginImagePreview,
        FilePondPluginFileValidateSize,
        FilePondPluginFileValidateType,
    );

    const inputImg = document.getElementById("filepond");
    const pond = FilePond.create(inputImg, {
        labelIdle: `Arraste & Solte sua imagem ou <span class="filepond--label-action">Selecione um Aquivo</span>`,
        labelMaxFileSizeExceeded: "Tamanho do arquivo excedeu o limite",
        labelFileTypeNotAllowed: "Tipo do arquivo não permitido"
    });

    // Submiting data to /api/quiz/salvar to save the quiz
    $("#form").submit(function(e){
        e.preventDefault();
    
        postform()
    })


    function postform(){
        //Prepare data
        let formdata = {
            titulo: $("#titulo").val(),
            desc: $("#desc").val()
        }
        
        $.ajax({
            type: 'POST',
            url: '/api/quiz/salvar',
            contentType: "application/json",
            data: JSON.stringify(formdata), 
            dataType: "json",
            
        }).done((res) => {
            Notification.success("Quiz criado com sucesso" + emoji.happy);
        }).fail(() => {
            Notification.error("Erro interno, Status : 400 " + emoji.sad);
        })
    
    }
    
        
    
</script>







